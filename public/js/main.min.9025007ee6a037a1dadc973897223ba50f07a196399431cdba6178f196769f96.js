(function(){"use strict";function s(e){document.readyState==="complete"||document.readyState==="interactive"?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}const e={init(){this.applyTheme(),this.bindEvents()},getTheme(){return localStorage.getItem("theme")||"auto"},setTheme(e){localStorage.setItem("theme",e),this.applyTheme()},applyTheme(){const e=this.getTheme(),t=e==="dark"||e==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.setAttribute("data-theme",t?"dark":"light"),document.body.classList.toggle("dark",t)},bindEvents(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.getTheme()==="auto"&&this.applyTheme()});const e=document.querySelector("#theme-toggle");e&&e.addEventListener("click",()=>{const e=this.getTheme(),t=e==="dark"?"light":"dark";this.setTheme(t)})}},o={init(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const n=e.getAttribute("href");if(n==="#")return;const s=document.querySelector(n);s&&(t.preventDefault(),s.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,n))})})}},i={init(){document.querySelectorAll("pre code").forEach(e=>{this.addCopyButton(e)})},addCopyButton(e){const n=e.parentNode,t=document.createElement("button");t.className="copy-code-btn",t.textContent="Copy",t.setAttribute("aria-label","Copy code to clipboard"),t.addEventListener("click",()=>{this.copyCode(e,t)}),n.style.position="relative",n.appendChild(t)},async copyCode(e,t){const n=e.textContent;try{await navigator.clipboard.writeText(n),t.textContent="Copied!",t.classList.add("copied"),setTimeout(()=>{t.textContent="Copy",t.classList.remove("copied")},2e3)}catch(e){console.error("Failed to copy code:",e),t.textContent="Failed",setTimeout(()=>{t.textContent="Copy"},2e3)}}},a={init(){if(!document.querySelector(".post-content"))return;this.createProgressBar(),this.updateProgress(),window.addEventListener("scroll",()=>this.updateProgress())},createProgressBar(){const e=document.createElement("div");e.className="reading-progress",e.innerHTML='<div class="reading-progress-fill"></div>',document.body.appendChild(e)},updateProgress(){const e=document.querySelector(".post-content");if(!e)return;const n=e.offsetTop,s=e.offsetHeight,o=window.pageYOffset,i=window.innerHeight,a=Math.min(100,Math.max(0,(o-n+i)/s*100)),t=document.querySelector(".reading-progress-fill");t&&(t.style.width=`${a}%`)}},r={init(){this.createButton(),this.bindEvents()},createButton(){const e=document.createElement("button");e.className="back-to-top",e.innerHTML="â†‘",e.setAttribute("aria-label","Back to top"),e.style.display="none",document.body.appendChild(e)},bindEvents(){const e=document.querySelector(".back-to-top");if(!e)return;window.addEventListener("scroll",()=>{window.pageYOffset>300?e.style.display="flex":e.style.display="none"}),e.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}},c={init(){document.querySelectorAll('a[href^="http"]').forEach(e=>{e.href.includes(window.location.hostname)||(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("aria-label",`${e.textContent} (opens in new tab)`))})}},l={init(){"IntersectionObserver"in window?this.setupIntersectionObserver():this.loadAllImages()},setupIntersectionObserver(){const e=document.querySelectorAll("img[data-src]"),t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,n.classList.remove("lazy"),t.unobserve(n)}})});e.forEach(e=>t.observe(e))},loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>{e.src=e.dataset.src,e.classList.remove("lazy")})}},t={init(){const e=document.querySelector("#search-input"),t=document.querySelector("#search-results");if(!e||!t)return;this.loadSearchIndex().then(()=>{this.bindEvents()})},async loadSearchIndex(){try{const e=await fetch("/index.json");this.searchIndex=await e.json()}catch(e){console.error("Failed to load search index:",e),this.searchIndex=[]}},bindEvents(){const t=document.querySelector("#search-input");let e;t.addEventListener("input",t=>{clearTimeout(e),e=setTimeout(()=>{this.performSearch(t.target.value)},300)})},performSearch(e){const t=document.querySelector("#search-results");if(!e.trim()){t.innerHTML="";return}const n=this.searchIndex.filter(t=>t.title.toLowerCase().includes(e.toLowerCase())||t.content.toLowerCase().includes(e.toLowerCase())).slice(0,10);if(n.length===0){t.innerHTML="<p>No results found.</p>";return}t.innerHTML=n.map(e=>`
                <div class="search-result">
                    <h3><a href="${e.permalink}">${e.title}</a></h3>
                    <p>${this.truncate(e.content,150)}</p>
                </div>
            `).join("")},truncate(e,t){return e.length<=t?e:e.substr(0,t)+"..."}},n={init(){if(localStorage.getItem("analytics-opt-out")==="true")return;this.trackPageView()},trackPageView(){"navigator"in window&&"sendBeacon"in navigator&&{page:window.location.pathname,referrer:document.referrer,timestamp:Date.now()}}},d={init(){"performance"in window&&window.addEventListener("load",()=>{setTimeout(()=>this.measurePerformance(),0)})},measurePerformance(){const e=performance.getEntriesByType("navigation")[0];if(e){const t=e.loadEventEnd-e.loadEventStart;console.log(`Page load time: ${t}ms`)}}};s(function(){e.init(),o.init(),i.init(),a.init(),r.init(),c.init(),l.init(),t.init(),n.init(),d.init(),document.body.classList.add("loading")}),window.BlogJS={ThemeManager:e,Search:t,Analytics:n}})()